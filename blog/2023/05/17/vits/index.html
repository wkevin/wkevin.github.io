<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="wkevin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="wkevin Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="wkevin JSON Feed">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">ViT ChatGPT 问答 | wkevin</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wkevin.github.io/blog/2023/05/17/vits"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ViT ChatGPT 问答 | wkevin"><meta data-rh="true" name="description" content="vits question and ananswer by ChatGPT"><meta data-rh="true" property="og:description" content="vits question and ananswer by ChatGPT"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-05-17T00:00:00.000Z"><meta data-rh="true" property="article:author" content="http://weibo.com/wkevin27"><meta data-rh="true" property="article:tag" content="vit"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://wkevin.github.io/blog/2023/05/17/vits"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2023/05/17/vits" hreflang="en"><link data-rh="true" rel="alternate" href="https://wkevin.github.io/blog/2023/05/17/vits" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.941905f7.css">
<link rel="preload" href="/assets/js/runtime~main.173e6b64.js" as="script">
<link rel="preload" href="/assets/js/main.4a461576.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="wkevin Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">wKevin</b></a><a class="navbar__item navbar__link" href="/docs/stack/">技术栈</a><a class="navbar__item navbar__link" href="/docs/project/industry/">业务场</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/blog/rss.xml">Feed</a><a href="https://github.com/wkevin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">ViT ChatGPT 问答</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2023-05-17T00:00:00.000Z" itemprop="datePublished">May 17, 2023</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="/img/avastar/angry.bird-l.jpg" alt="wKevin"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">wKevin</span></a></div><small class="avatar__subtitle" itemprop="description">一颗向上的水滴</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>熟悉 ViT（Vision Transformer）训练视觉模型的基本原理以及其典型方法（如 MAE，Mask Autoencoding）</p><p>文中以下面形式引用 ChatGPT 答复：</p><blockquote><ul><li>提问</li></ul><blockquote><p>ChatGPT 的回答</p></blockquote></blockquote><hr><blockquote><ul><li>ViT 模型出现的时间、paper、提出人</li></ul><blockquote><p>ViT 模型是由 Anish Athalye、Nicholas Carlini 和 David Wagner 等人于 2020 年在《Advances in Neural Information Processing Systems》会议上发布的论文<strong>《An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale》</strong>中提出的。该论文开创性地将 Transformer 应用于计算机视觉领域，提出了一种名为 Vision Transformer（ViT）的模型，用于图像分类等计算机视觉任务。</p></blockquote></blockquote><p>paper 链接：<a href="http://arxiv.org/abs/2010.11929" target="_blank" rel="noopener noreferrer">http://arxiv.org/abs/2010.11929</a>: v1(2020.10), v2(2021.6)</p><p>摘要：</p><p>While the Transformer architecture has become the de-facto standard for natural language processing tasks, its applications to computer vision remain limited. In vision, attention is either applied in conjunction with convolutional networks, or used to replace certain components of convolutional networks while keeping their overall structure in place. We show that this reliance on CNNs is not necessary and a pure transformer applied directly to sequences of image patches can perform very well on image classification tasks. When pre-trained on large amounts of data and transferred to multiple mid-sized or small image recognition benchmarks (ImageNet, CIFAR-100, VTAB, etc.), Vision Transformer (ViT) attains excellent results compared to state-of-the-art convolutional networks while requiring substantially fewer computational resources to train.</p><p>虽然 Transformer 体系结构已经成为自然语言处理任务的事实上的标准，但它在计算机视觉方面的应用仍然有限。在视觉上，注意力要么与卷积网络结合使用，要么用于替换卷积网络的某些组件，同时保持其整体结构不变。我们表明，这种对 CNN 的依赖是不必要的，直接应用于图像块序列的纯变换可以很好地执行图像分类任务。在对大量数据进行预训练并传输到多个中型或小型图像识别基准(ImageNet、CIFAR-100、VTAB 等)时，Vision Transformer(VIT)与最先进的卷积网络相比获得了出色的结果，同时需要训练的计算资源大大减少。</p><hr><blockquote><ul><li>在 ViT 出现之前，Transformer 在视觉领域上使用都有哪些难点、痛点</li></ul><blockquote><ol><li>需要大量的计算资源：由于图像具有高分辨率和大量的像素，如果直接使用 Transformer 进行计算会产生庞大的计算量，因而需要大量的计算资源和更复杂的计算方法。</li><li>缺乏位置信息的输入：Transformer 主要是用于处理序列数据，在其应用于视觉任务时，需要将图像分成小块或将其压缩为一个向量，这样会导致一定程度上的信息丢失，尤其是位置信息的丢失，这在图像分类等任务中往往起着至关重要的作用。</li><li>对于输入序列的长度敏感：由于 Transformer 的计算复杂度与输入序列的长度相关，因而对于不同大小的图像，需要进行不同的调整来处理，这将会带来时空复杂度方面的问题。</li><li>无法处理变长输入：由于图像的大小和比例各不相同，需要根据实际情况对输入图像进行缩放和裁剪，这将使得数据的大小和形状不同，从而难以处理。</li></ol></blockquote></blockquote><p>Transformer Paper: <a href="http://arxiv.org/abs/1706.03762" target="_blank" rel="noopener noreferrer">http://arxiv.org/abs/1706.03762</a></p><p><img loading="lazy" src="/assets/images/2023-05-17-17-09-02-f1f2ef86afefb7cd65754112c7e8a273.png#size40" width="521" height="773" class="img_E7b_"></p><blockquote><ul><li>描述一下 Transformer 模型中的注意力机制</li></ul><blockquote><p>在 Transformer 模型中，注意力机制是其中非常重要的组成部分。注意力机制本质上是一种加权平均，可以将输入序列中每个位置的信息集成到其他位置上。以自注意力机制（self-attention）为例，它将输入序列中的每个元素（也就是向量）映射到三个向量上，分别是查询向量（query）、键向量（key）和值向量（value）。这些向量由输入序列的线性变换得到，不同的线性变换矩阵用于产生不同的查询、键和值向量。
接着，为了计算任何一个位置的表示，我们需要将该位置的查询向量与所有包括自身在内的键向量进行点积，然后再对这些结果进行归一化，形成一个权重分布。最后将该位置的值向量与这些归一化权重相乘，并将它们相加起来，这就产生了该位置的表示，如下述公式所示：
<img loading="lazy" src="/assets/images/2023-05-17-17-34-14-5e2909c6f70d1e217f94c96a7441d025.png#size60" width="672" height="381" class="img_E7b_">
在 Transformer 模型中，自注意力机制不仅可以在编码器中使用，而且可以在解码器中使用，以实现对输入序列和已经生成的部分解码序列的强大的交互和联合建模能力。注意力机制的加入使得模型能够有效地处理各种序列数据，这也是 Transformer 模型在语言模型和其他自然语言处理任务上取得成功的原因之一。</p></blockquote></blockquote><hr><blockquote><ul><li>介绍一下 ViT 模型的核心内容</li></ul><blockquote><p>ViT (Vision Transformer) 是一种使用 Transformer 结构进行图像分类的模型。该模型由 Google Brain 提出，旨在探索将 Transformer 应用于计算机视觉任务的可能性。
ViT 模型首先将图像分解成一组固定大小的图块，每个图块通过预定义的线性投影映射到一个向量空间中。接下来，模型使用 Transformer 结构对这些向量执行自注意力操作，并在不同的 Transformer 块之间添加全局平均池化操作，最终将这些向量输入到一个全连接层进行分类。
与传统的卷积神经网络相比，ViT 模型的架构更加简单明了，并且具有更高的灵活性，能够处理输入图像的大小和分辨率的变化。此外，ViT 模型在一些计算机视觉基准测试上取得了与最先进的卷积神经网络相当的性能。
然而，相对于传统的卷积神经网络，ViT 模型需要更多的计算资源和更长的训练时间，因为它需要处理大量的小块图像，并且由于 ViT 排列成网格状，使得其对于一些位置相关性较强的视觉任务表现不如 CNN。
ViT 模型的出现和成功应用，为使用 Transformer 解决视觉领域的问题提供了新的思路和方法。</p></blockquote></blockquote><p>ViT 论文中最核心的结论是：<strong>当拥有足够多的数据进行预训练的时候，ViT 的表现就会超过 CNN，突破 transformer 缺少归纳偏置的限制，可以在下游任务中获得较好的迁移效果。</strong></p><p><img loading="lazy" src="/assets/images/2023-05-17-16-55-31-6338840455358cfc3bed38b4ee7ea381.png" width="720" height="361" class="img_E7b_"></p><p>在 nlp 中，输入 transformer 中的是一个序列，而在视觉领域，需要考虑如何将一个 2d 图片转化为一个 1d 的序列，最直观的想法就是将图片中的像素点输入到 transformer 中，但是这样会有一个问题，因为模型训练中图片的大小是 224<!-- -->*<!-- -->224=50176，而正常的 bert 的序列长度是 512，是 bert 的 100 倍，这个的复杂度太高了。</p><p>ViT 怎么做前向（上图右侧）：将图片切分成 16x16 的 patch，每一个 patch 作为一个 token 输入到 transformer</p><ul><li>每个 <code>224*224</code> 的图片得到 196 个 patch</li><li>每个 patch <code>16*16*3=768</code> 维向量（3 是 RGB 通道个数）</li><li>给每个 patch embedding 加上一个 position embedding（cls），196 个 patch 得到 196 个位置—— 借鉴 bert</li><li>所以整个输入是 <code>197*768</code> 维向量</li></ul><hr><blockquote><ul><li>ViT 模型对后续的 Transformer 视觉模型的影响和继承关系</li></ul><blockquote><p>ViT 模型作为一种将 Transformer 模型应用于计算机视觉任务的先驱，对后续的 Transformer 视觉模型有着重要的影响和启发作用。对于后续的 Transformer 视觉模型，可以总结出以下的继承和影响关系：</p><ol><li>缩小网络规模：ViT 模型的提出标志着 Transformer 模型在视觉领域的应用实现。但是，由于 ViT 模型中需要划分为固定的图块以适应 Transformer，这会导致模型对输入分辨率的敏感度而不适用于高分辨率图像。后续的 Transformer 视觉模型例如 DETR 和 Swin Transformer 等，都在模型压缩和性能提升上做出了改进和优化，使得模型更加轻量化、高效。</li><li>使用不同的位置编码：ViT 模型中使用的绝对位置编码方式是基于位置信息的，每个位置的编码都是固定的，而这可能会对模型的泛化能力造成一定的影响。因此，一些后续的模型也尝试了使用相对位置编码等更加灵活、多样化的位置编码方式，来增强模型的泛化和适应能力，例如 Swin Transformer 和 PVT 等模型。</li><li>增加特征金字塔结构：ViT 模型在将高分辨率图像转换为小块特征表示上存在一定的局限性。一些后续模型，例如 Swin Transformer 就利用特征金字塔结构（FPN）来实现多层特征的融合，获取更全局和复杂的上下文信息，并进一步提升模型的性能。
总之，ViT 模型的提出为 Transformer 模型在视觉领域的应用开启了新的方向和思路。后续的 Transformer 视觉模型在融合更多优秀技术的同时，也不断突破和完善着基于 Transformer 的计算机视觉模型框架。</li></ol></blockquote></blockquote></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/vit">vit</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2023/07/03/matplotlib.zh.font"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">配置 matplotlib 中文字体</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2023/04/25/llm.survey"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">LLM 概览</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="http://weibo.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">微博</a></li><li class="footer__item"><a href="https://twitter.com/wkevin27" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://gitee.com/wkevin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee</a></li><li class="footer__item"><a href="https://blog.csdn.net/kevin881" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN</a></li></ul></div><div class="col footer__col"><div class="footer__title">Awesome</div><ul class="footer__items"><li class="footer__item"><a href="https://arxiv.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Arxiv</a></li><li class="footer__item"><a href="https://www.tianlangbooks.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">天浪书屋</a></li><li class="footer__item"><a href="https://yts.mx/" target="_blank" rel="noopener noreferrer" class="footer__link-item">YTS</a></li></ul></div><div class="col footer__col"><div class="footer__title">Collaborate</div><ul class="footer__items"><li class="footer__item"><a href="https://mubu.com/app" target="_blank" rel="noopener noreferrer" class="footer__link-item">幕布</a></li><li class="footer__item"><a href="https://shimo.im/" target="_blank" rel="noopener noreferrer" class="footer__link-item">石墨</a></li><li class="footer__item"><a href="https://www.feishu.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">飞书</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 wkevin, built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.173e6b64.js"></script>
<script src="/assets/js/main.4a461576.js"></script>
</body>
</html>